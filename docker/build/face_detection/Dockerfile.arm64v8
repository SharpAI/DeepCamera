FROM shareai/tensorflow:arm64v8_latest
ENV DEBIAN_FRONTEND noninteractive

RUN apt-get update && apt-get install --no-install-recommends  -y python python-pip python-opencv \
    zlib1g-dev libjpeg62-turbo-dev libopencv-dev libopencv-ts-dev python-pil python-scipy python-matplotlib \
    python-numpy python-pil python-scipy python-skimage libopencv-videostab-dev && \
    apt-get clean

RUN pip install --upgrade setuptools  && pip install --upgrade pip

ADD ./assets/face_detection-2.2.0-cp27-cp27mu-linux_aarch64.whl /root/face_detection-2.2.0-cp27-cp27mu-linux_aarch64.whl
RUN pip install /root/face_detection-2.2.0-cp27-cp27mu-linux_aarch64.whl && \
    rm /root/face_detection-2.2.0-cp27-cp27mu-linux_aarch64.whl
ADD requirements.txt /root/requirements.txt
RUN pip install -r /root/requirements.txt
ADD detection /root/detection
WORKDIR /root/detection/
RUN python ./test.py
